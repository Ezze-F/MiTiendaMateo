{% load static %}
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inicio de sesi√≥n</title>
    <link rel="stylesheet" href="{% static 'css/login.css' %}">
</head>
<body>
    <div class="login-container">
        <div class="login-form">
            <div class="logo-container">
                <img src="{% static 'img/logo.png' %}" alt="Logo" class="brand-logo">
            </div>
            <h2>Acceso al sistema</h2>

            {% if messages %}
                <ul class="messages-list">
                    {% for message in messages %}
                        <li class="message-item {{ message.tags }}">
                            {{ message }}
                        </li>
                    {% endfor %}
                </ul>
            {% endif %}

            <form action="{% url 'a_login:login' %}" method="post">
                {% csrf_token %}

                <div class="input-group">
                    <label for="{{ form.username.id_for_label }}">{{ form.username.label }}</label>
                    {{ form.username }}
                    {% if form.username.errors %}
                        <p class="error-text">{{ form.username.errors }}</p>
                    {% endif %}
                </div>

                <div class="input-group">
                    <label for="{{ form.password.id_for_label }}">{{ form.password.label }}</label>
                    
                    <div class="password-toggle-container">
                        {{ form.password }}
                        <span class="password-toggle-icon" id="togglePassword">üëÅÔ∏è</span>
                    </div>
                    
                    {% if form.password.errors %}
                        <p class="error-text">{{ form.password.errors }}</p>
                    {% endif %}
                </div>

                {% if form.non_field_errors %}
                    <p class="error-text">{{ form.non_field_errors }}</p>
                {% endif %}
                
                <button type="submit" class="login-button">Iniciar Sesi√≥n</button>
            </form>
            
            <a href="#" class="forgot-password">¬øOlvidaste tu contrase√±a?</a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // 1. Obtener el input de la contrase√±a
            const passwordInput = document.getElementById('{{ form.password.id_for_label }}'); 
            
            // 2. Obtener el √≠cono/bot√≥n
            const toggleIcon = document.getElementById('togglePassword');

            // 3. Verificar que ambos elementos existan
            if (passwordInput && toggleIcon) {
                // 4. Agregar un 'escuchador' de evento (listener) al √≠cono
                toggleIcon.addEventListener('click', function () {
                    // Determinar el tipo actual del campo
                    const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                    
                    // Cambiar el tipo del campo
                    passwordInput.setAttribute('type', type);
                    
                    // Cambiar el √≠cono (opcional, para feedback visual)
                    if (type === 'text') {
                        this.textContent = 'üîí'; // Ocultar
                        this.setAttribute('aria-label', 'Ocultar contrase√±a');
                    } else {
                        this.textContent = 'üëÅÔ∏è'; // Mostrar
                        this.setAttribute('aria-label', 'Mostrar contrase√±a');
                    }
                });
            }
        });
    </script>
    
</body>
</html>
